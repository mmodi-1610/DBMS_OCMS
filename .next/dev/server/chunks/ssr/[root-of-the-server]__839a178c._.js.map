{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///home/ar009/Desktop/DBMS%20Lab/A4/DBMS_OCMS/lib/db.js"],"sourcesContent":["import { neon } from \"@neondatabase/serverless\";\n\nexport const sql = neon(process.env.DATABASE_URL);\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,MAAM,IAAA,8JAAI,EAAC,QAAQ,GAAG,CAAC,YAAY"}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///home/ar009/Desktop/DBMS%20Lab/A4/DBMS_OCMS/lib/auth.js"],"sourcesContent":["import { cookies } from \"next/headers\";\nimport { sql } from \"./db\";\n\nexport async function getSession() {\n  const cookieStore = await cookies();\n  const session = cookieStore.get(\"quadbase_session\");\n  if (!session?.value) return null;\n\n  try {\n    const parsed = JSON.parse(session.value);\n    return parsed;\n  } catch {\n    return null;\n  }\n}\n\nexport async function login(username, password) {\n  try {\n    const rows = await sql`\n      SELECT id, username, password_hash, role\n      FROM app_user\n      WHERE username = ${username}\n    `;\n\n    if (rows.length === 0) return null;\n\n    const user = rows[0];\n\n    // For demo purposes, password is stored as plain text\n    if (user.password_hash !== password) return null;\n\n    const sessionUser = {\n      id: user.id,\n      username: user.username,\n      role: user.role,\n    };\n\n    const cookieStore = await cookies();\n    cookieStore.set(\"quadbase_session\", JSON.stringify(sessionUser), {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === \"production\",\n      sameSite: \"lax\",\n      maxAge: 60 * 60 * 24, // 24 hours\n      path: \"/\",\n    });\n\n    return sessionUser;\n  } catch (err) {\n    console.error(\"Database error during login:\", err);\n    throw err;\n  }\n}\n\nexport async function logout() {\n  const cookieStore = await cookies();\n  cookieStore.delete(\"quadbase_session\");\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,MAAM,UAAU,YAAY,GAAG,CAAC;IAChC,IAAI,CAAC,SAAS,OAAO,OAAO;IAE5B,IAAI;QACF,MAAM,SAAS,KAAK,KAAK,CAAC,QAAQ,KAAK;QACvC,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,MAAM,QAAQ,EAAE,QAAQ;IAC5C,IAAI;QACF,MAAM,OAAO,MAAM,gHAAG,CAAC;;;uBAGJ,EAAE,SAAS;IAC9B,CAAC;QAED,IAAI,KAAK,MAAM,KAAK,GAAG,OAAO;QAE9B,MAAM,OAAO,IAAI,CAAC,EAAE;QAEpB,sDAAsD;QACtD,IAAI,KAAK,aAAa,KAAK,UAAU,OAAO;QAE5C,MAAM,cAAc;YAClB,IAAI,KAAK,EAAE;YACX,UAAU,KAAK,QAAQ;YACvB,MAAM,KAAK,IAAI;QACjB;QAEA,MAAM,cAAc,MAAM,IAAA,0IAAO;QACjC,YAAY,GAAG,CAAC,oBAAoB,KAAK,SAAS,CAAC,cAAc;YAC/D,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK;YAClB,MAAM;QACR;QAEA,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 90, "column": 0}, "map": {"version":3,"sources":["file:///home/ar009/Desktop/DBMS%20Lab/A4/DBMS_OCMS/components/login-form.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const LoginForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call LoginForm() from the server but LoginForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/login-form.jsx <module evaluation>\",\n    \"LoginForm\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,YAAY,IAAA,wQAAuB,EAC5C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,2DACA","ignoreList":[0]}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///home/ar009/Desktop/DBMS%20Lab/A4/DBMS_OCMS/components/login-form.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const LoginForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call LoginForm() from the server but LoginForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/login-form.jsx\",\n    \"LoginForm\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,YAAY,IAAA,wQAAuB,EAC5C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,uCACA","ignoreList":[0]}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///home/ar009/Desktop/DBMS%20Lab/A4/DBMS_OCMS/app/page.jsx"],"sourcesContent":["import { redirect } from \"next/navigation\";\nimport { getSession } from \"@/lib/auth\";\nimport { LoginForm } from \"@/components/login-form\";\n\nexport default async function LoginPage() {\n  const session = await getSession();\n  if (session) {\n    redirect(\"/dashboard\");\n  }\n\n  return <LoginForm />;\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AACA;AACA;;;;;AAEe,eAAe;IAC5B,MAAM,UAAU,MAAM,IAAA,yHAAU;IAChC,IAAI,SAAS;QACX,IAAA,iMAAQ,EAAC;IACX;IAEA,qBAAO,8OAAC,yIAAS;;;;;AACnB"}}]
}